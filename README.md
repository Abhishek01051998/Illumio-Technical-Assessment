# Flow Log Parser and Lookup Table

This program parses flow logs, matches destination ports and protocols to tags from a lookup table, and generates counts of the occurrences of each tag and port/protocol combination. It also handles untagged flow logs and outputs the results to a text file.

## Features

- **Load a lookup table** from a CSV file where each row contains a destination port (`dstport`), protocol, and corresponding tag.
- **Parse flow logs** from a text file containing flow log data.
- **Count tag occurrences** and the number of flow logs for each port/protocol combination.
- **Output results** to a text file with:
  - Tag counts (including the untagged flow logs).
  - Counts for each port/protocol combination.

## Prerequisites

- Python 3.x
- CSV file format for the lookup table
- Flow log file in text format

## Files

- **lookup_table.csv**: The CSV file used as the lookup table. It must contain the following columns:
  - `dstport`: Destination port (integer).
  - `protocol`: Protocol (can be "tcp", "udp", or "icmp").
  - `tag`: Associated tag (string).
  
- **flow_log.txt**: The text file containing flow log entries. Each line should have at least the destination port and protocol number in the following positions:
  - Destination port: Column 6
  - Protocol number: Column 8
  
- **output.txt**: The output file generated by the program, containing the parsed counts.

## How to Use

1. **Prepare your files**:
   - Ensure you have a `lookup_table.csv` with the appropriate structure (dstport, protocol, and tag).
   - Ensure your flow log file is in the correct format (`flow_log.txt`).

2. **Run the script**:
   Run the script by executing the following command:
   ```bash
   python Assessment.py
3. **Assumptions and Limitations**:
   - The flow log format must strictly follow the default log format; custom log formats are not supported.
   - Only version 2 of the flow log format is supported.
   - The CSV lookup table must have the following format:
   - dstport: Destination port (integer)
   - protocol: Protocol (string, either 'tcp', 'udp', or 'icmp')
   - tag: The tag to associate with the flow log (string)

4. **Testing and Analysis**:
   - Test 1: A flow log with multiple entries that match known ports and protocols, ensuring correct tag counts and port/protocol combination counts.
   - Test 2: A flow log with entries that do not match any known ports/protocols, ensuring they are counted under "Untagged."
   - Test 3: A flow log with mixed tag and non-tag entries to ensure proper handling of untagged flows.

## Code Structure

1. **`Assessment.py`**:  
   The main script that contains the logic for:
   - Parsing flow logs.
   - Loading the lookup table (CSV).
   - Writing the parsed results (tag and port/protocol counts) to the output file.

2. **`lookup_table.csv`**:  
   A CSV file containing port/protocol/tag mappings. The format should include:
   - **dstport**: The destination port (integer).
   - **protocol**: The protocol (either 'tcp', 'udp', or 'icmp').
   - **tag**: A tag to associate with the flow log (string).
3. **`flow_log.txt`**:  
A text file containing flow logs in a space-separated format. Each log entry must contain the destination port and protocol number, along with other necessary information.
4. **`output.txt`**:  
The output file generated by the program. It contains:
- **Tag Counts**: Counts of logs matched with each tag.
- **Port/Protocol Counts**: Counts of logs for each unique port/protocol combination.


